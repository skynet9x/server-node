`use strict`;

const fs = require(`fs-extra`);
const checkFilename = require(`${__dirname}/../helper/checkFilename.js`);
const checkDirname = require(`${__dirname}/../helper/checkDirname.js`);

function setAllSync(_this, arg1, arg2) {

  if (arg1) {
    if (arg2) {
      // set dir
      checkDirname(arg1);
      fs.ensureDirSync(`${_this.dir}/${arg1}`);
      for (const key in arg2) {
        checkFilename(key);
        fs.writeJsonSync(`${_this.dir}/${arg1}/${key}.json`, arg2[key], _this.options);
      }
      if(_this.options.git){
        _this.git.addSync(`"${_this.dir}/${arg1}"`);
        _this.git.commitSync(`"${_this.dir}/${arg1}"`, `setAllSync: ${arg1}`);
      }
    } else {
      // set storage
      for (const dir in arg1) {
        checkDirname(dir);
        fs.ensureDirSync(`${_this.dir}/${dir}`);
        for (const file in arg1[dir]) {
          checkFilename(file);
          fs.writeJsonSync(`${_this.dir}/${dir}/${file}.json`, arg1[dir][file], _this.options);
        }
      }
      if(_this.options.git){
        _this.git.addSync(`.`);
        _this.git.commitSync(``, `setAllSync: complete storage`);
      }
    }
  }

}

module.exports = setAllSync;