`use strict`;

const fs = require(`fs-extra`);
const checkDirname = require(`${__dirname}/../helper/checkDirname.js`);
const checkFilename = require(`${__dirname}/../helper/checkFilename.js`);

async function set(_this, dir, file, json) {
  checkDirname(dir);
  await fs.ensureDir(`${_this.dir}/${dir}`);

  if(file){
    checkFilename(file);
    const path = `${_this.dir}/${dir}/${file}.json`;
    await fs.writeJson(path, json, _this.options);

    if(_this.options.git){
      await _this.git.add(`"${path}"`);
      await _this.git.commit(`"${path}"`, `set: ${file}`);
    }
    
  }
  
}

module.exports = set;
