`use strict`;

const fs = require(`fs-extra`);
const checkNames = require(`${__dirname}/../helper/checkNames.js`);
const checkDirname = require(`${__dirname}/../helper/checkDirname.js`);

async function remove(_this, dir, file) {
  //if file is set, remove file
  if (file) {
    // throw error if names not valid
    checkNames(dir, file);

    const path = `${_this.dir}/${dir}/${file}.json`;

    await fs.remove(path);

    if(_this.options.git){
      await _this.git.add(`"${path}"`);
      await _this.git.commit(`"${path}"`, `remove: ${file}`);
    }

  } else {
    //else remove the dir
    checkDirname(dir);

    const path = `${_this.dir}/${dir}`;
    await fs.remove(path);

    if(_this.options.git){
      await _this.git.add(`"${path}"`);
      await _this.git.commit(`"${path}"`, `remove: ${dir}`);
    }
  }

}

module.exports = remove;
